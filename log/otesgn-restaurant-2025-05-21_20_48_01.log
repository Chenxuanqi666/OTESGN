cuda memory allocated: 446503424
n_trainable_params: 111109409, n_nontrainable_params: 0
training arguments:
>>> model_name: otesgn
>>> dataset: restaurant
>>> contrastive: True
>>> short_drop: 0.1
>>> alpha: 0.8
>>> num_layers: 5
>>> attdim: 200
>>> polarities_dim: 3
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f7ae8063280>
>>> learning_rate: 0.001
>>> l2reg: 2e-05
>>> batch_size: 64
>>> num_epoch: 30
>>> log_step: 5
>>> embed_dim: 300
>>> post_dim: 30
>>> pos_dim: 30
>>> hidden_dim: 50
>>> input_dropout: 0.7
>>> gcn_dropout: 0.1
>>> lower: True
>>> direct: False
>>> loop: True
>>> bidirect: True
>>> rnn_hidden: 50
>>> rnn_layers: 1
>>> rnn_dropout: 0.1
>>> attention_heads: 5
>>> max_length: 100
>>> device: cuda
>>> seed: 1000
>>> weight_decay: 0.0
>>> vocab_dir: ./dataset/Laptops_corenlp
>>> pad_id: 0
>>> parseadj: False
>>> parsehead: False
>>> cuda: 0
>>> losstype: None
>>> beta: 0.25
>>> pretrained_bert_name: bert-base-uncased
>>> adam_epsilon: 1e-08
>>> bert_dim: 768
>>> bert_dropout: 0.3
>>> diff_lr: True
>>> bert_lr: 2e-05
>>> model_class: <class 'models.ssegcn_bert_2.SSEGCNBertClassifier_with_OT_2'>
>>> dataset_file: {'train': './dataset/Restaurants_corenlp/train_write.json', 'test': './dataset/Restaurants_corenlp/test_write.json'}
>>> inputs_cols: ['text_bert_indices', 'bert_segments_ids', 'attention_mask', 'asp_start', 'asp_end', 'src_mask', 'aspect_mask', 'short_mask']
layered learning rate on
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.6169_f1_0.2544
loss: 0.8684, acc: 0.6250, test_acc: 0.6169, f1: 0.2544
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.6580_f1_0.4151
loss: 0.7056, acc: 0.6719, test_acc: 0.6580, f1: 0.4151
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.7554_f1_0.6004
loss: 0.6582, acc: 0.6719, test_acc: 0.7554, f1: 0.6004
loss: 0.5770, acc: 0.6875, test_acc: 0.7424, f1: 0.5781
loss: 0.6730, acc: 0.6844, test_acc: 0.7554, f1: 0.6440
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.7641_f1_0.5781
loss: 0.4569, acc: 0.7083, test_acc: 0.7641, f1: 0.5781
loss: 0.7044, acc: 0.7121, test_acc: 0.7532, f1: 0.6434
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.7879_f1_0.6608
loss: 0.4988, acc: 0.7227, test_acc: 0.7879, f1: 0.6608
loss: 0.6161, acc: 0.7257, test_acc: 0.7727, f1: 0.6668
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.7900_f1_0.6653
loss: 0.4260, acc: 0.7359, test_acc: 0.7900, f1: 0.6653
loss: 0.4746, acc: 0.7401, test_acc: 0.7662, f1: 0.6595
loss: 0.5052, acc: 0.7448, test_acc: 0.7619, f1: 0.6412
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8030_f1_0.6904
loss: 0.3752, acc: 0.7524, test_acc: 0.8030, f1: 0.6904
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.5008, acc: 0.8125, test_acc: 0.7987, f1: 0.6948
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8139_f1_0.7405
loss: 0.4500, acc: 0.8125, test_acc: 0.8139, f1: 0.7405
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8160_f1_0.7488
loss: 0.3944, acc: 0.8177, test_acc: 0.8160, f1: 0.7488
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8203_f1_0.7231
loss: 0.1735, acc: 0.8555, test_acc: 0.8203, f1: 0.7231
loss: 0.3669, acc: 0.8594, test_acc: 0.8117, f1: 0.6972
loss: 0.4882, acc: 0.8490, test_acc: 0.8160, f1: 0.7539
loss: 0.1616, acc: 0.8638, test_acc: 0.8160, f1: 0.7186
loss: 0.3985, acc: 0.8574, test_acc: 0.7965, f1: 0.7349
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8225_f1_0.7284
loss: 0.2133, acc: 0.8698, test_acc: 0.8225, f1: 0.7284
loss: 0.3829, acc: 0.8625, test_acc: 0.7965, f1: 0.7409
loss: 0.3152, acc: 0.8651, test_acc: 0.8052, f1: 0.6804
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8247_f1_0.7622
loss: 0.3952, acc: 0.8646, test_acc: 0.8247, f1: 0.7622
loss: 0.4656, acc: 0.8606, test_acc: 0.8052, f1: 0.6819
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.2879, acc: 0.8594, test_acc: 0.8160, f1: 0.7133
loss: 0.2474, acc: 0.8750, test_acc: 0.8203, f1: 0.7409
loss: 0.3744, acc: 0.8646, test_acc: 0.8074, f1: 0.7083
loss: 0.4440, acc: 0.8711, test_acc: 0.8074, f1: 0.7522
loss: 0.2988, acc: 0.8750, test_acc: 0.7922, f1: 0.6383
loss: 0.2930, acc: 0.8802, test_acc: 0.7965, f1: 0.7047
loss: 0.3417, acc: 0.8772, test_acc: 0.8009, f1: 0.7379
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8333_f1_0.7478
loss: 0.3136, acc: 0.8770, test_acc: 0.8333, f1: 0.7478
loss: 0.4391, acc: 0.8767, test_acc: 0.8160, f1: 0.7258
loss: 0.2584, acc: 0.8781, test_acc: 0.8052, f1: 0.7552
loss: 0.1844, acc: 0.8849, test_acc: 0.8247, f1: 0.7240
loss: 0.3066, acc: 0.8841, test_acc: 0.8225, f1: 0.7359
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8377_f1_0.7812
loss: 0.2656, acc: 0.8834, test_acc: 0.8377, f1: 0.7812
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8420_f1_0.7816
loss: 0.2413, acc: 0.8884, test_acc: 0.8420, f1: 0.7816
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8485_f1_0.7760
loss: 0.1915, acc: 0.9375, test_acc: 0.8485, f1: 0.7760
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8506_f1_0.7868
loss: 0.2529, acc: 0.9297, test_acc: 0.8506, f1: 0.7868
loss: 0.2215, acc: 0.9219, test_acc: 0.8398, f1: 0.7809
loss: 0.1676, acc: 0.9297, test_acc: 0.8377, f1: 0.7598
loss: 0.2213, acc: 0.9313, test_acc: 0.8442, f1: 0.7797
loss: 0.1939, acc: 0.9349, test_acc: 0.8160, f1: 0.7691
loss: 0.2023, acc: 0.9330, test_acc: 0.8463, f1: 0.7783
loss: 0.1696, acc: 0.9336, test_acc: 0.8506, f1: 0.7857
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8528_f1_0.7946
loss: 0.1540, acc: 0.9323, test_acc: 0.8528, f1: 0.7946
loss: 0.2109, acc: 0.9328, test_acc: 0.8139, f1: 0.7236
loss: 0.3301, acc: 0.9290, test_acc: 0.8290, f1: 0.7474
loss: 0.0890, acc: 0.9310, test_acc: 0.8182, f1: 0.7562
loss: 0.1514, acc: 0.9327, test_acc: 0.8463, f1: 0.7843
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.1311, acc: 0.9375, test_acc: 0.8312, f1: 0.7639
loss: 0.2443, acc: 0.9297, test_acc: 0.8312, f1: 0.7766
loss: 0.1109, acc: 0.9323, test_acc: 0.8268, f1: 0.7498
loss: 0.0856, acc: 0.9453, test_acc: 0.8420, f1: 0.7774
loss: 0.0991, acc: 0.9500, test_acc: 0.8420, f1: 0.7786
loss: 0.1770, acc: 0.9505, test_acc: 0.8333, f1: 0.7684
loss: 0.0296, acc: 0.9576, test_acc: 0.8398, f1: 0.7806
loss: 0.1401, acc: 0.9531, test_acc: 0.8312, f1: 0.7756
loss: 0.1744, acc: 0.9531, test_acc: 0.8052, f1: 0.7077
loss: 0.1292, acc: 0.9547, test_acc: 0.8312, f1: 0.7660
loss: 0.1181, acc: 0.9560, test_acc: 0.8355, f1: 0.7664
loss: 0.0429, acc: 0.9583, test_acc: 0.8333, f1: 0.7629
loss: 0.1124, acc: 0.9591, test_acc: 0.8290, f1: 0.7670
loss: 0.1099, acc: 0.9599, test_acc: 0.8377, f1: 0.7662
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.0728, acc: 0.9844, test_acc: 0.8377, f1: 0.7680
loss: 0.0667, acc: 0.9766, test_acc: 0.8203, f1: 0.7602
loss: 0.0811, acc: 0.9792, test_acc: 0.8203, f1: 0.7388
loss: 0.1926, acc: 0.9688, test_acc: 0.8312, f1: 0.7460
loss: 0.0173, acc: 0.9750, test_acc: 0.8268, f1: 0.7685
loss: 0.0654, acc: 0.9740, test_acc: 0.8182, f1: 0.7575
loss: 0.0875, acc: 0.9732, test_acc: 0.8139, f1: 0.7239
loss: 0.0357, acc: 0.9746, test_acc: 0.8247, f1: 0.7458
loss: 0.0746, acc: 0.9740, test_acc: 0.8160, f1: 0.7517
loss: 0.1435, acc: 0.9734, test_acc: 0.8247, f1: 0.7603
loss: 0.0853, acc: 0.9744, test_acc: 0.8247, f1: 0.7315
loss: 0.1472, acc: 0.9714, test_acc: 0.8203, f1: 0.7480
loss: 0.0845, acc: 0.9724, test_acc: 0.8268, f1: 0.7601
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.0328, acc: 1.0000, test_acc: 0.8268, f1: 0.7555
loss: 0.0748, acc: 0.9844, test_acc: 0.8442, f1: 0.7744
loss: 0.0481, acc: 0.9844, test_acc: 0.8333, f1: 0.7669
loss: 0.0360, acc: 0.9844, test_acc: 0.8333, f1: 0.7730
loss: 0.0650, acc: 0.9844, test_acc: 0.8420, f1: 0.7692
loss: 0.1699, acc: 0.9792, test_acc: 0.8420, f1: 0.7587
loss: 0.2264, acc: 0.9732, test_acc: 0.8485, f1: 0.7824
loss: 0.0936, acc: 0.9746, test_acc: 0.8398, f1: 0.7724
loss: 0.0248, acc: 0.9774, test_acc: 0.8333, f1: 0.7527
loss: 0.0958, acc: 0.9734, test_acc: 0.8225, f1: 0.7589
loss: 0.1010, acc: 0.9744, test_acc: 0.8268, f1: 0.7589
loss: 0.3134, acc: 0.9701, test_acc: 0.8268, f1: 0.7464
loss: 0.0305, acc: 0.9724, test_acc: 0.8182, f1: 0.7426
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.1185, acc: 0.9688, test_acc: 0.8333, f1: 0.7688
loss: 0.0933, acc: 0.9688, test_acc: 0.8333, f1: 0.7636
loss: 0.1179, acc: 0.9583, test_acc: 0.8463, f1: 0.7720
loss: 0.1308, acc: 0.9570, test_acc: 0.8420, f1: 0.7890
loss: 0.0118, acc: 0.9656, test_acc: 0.8377, f1: 0.7658
loss: 0.0352, acc: 0.9688, test_acc: 0.8290, f1: 0.7391
loss: 0.0264, acc: 0.9710, test_acc: 0.8333, f1: 0.7503
loss: 0.2171, acc: 0.9648, test_acc: 0.8442, f1: 0.7878
loss: 0.1123, acc: 0.9653, test_acc: 0.8442, f1: 0.7830
loss: 0.0701, acc: 0.9672, test_acc: 0.8268, f1: 0.7547
loss: 0.0905, acc: 0.9673, test_acc: 0.8398, f1: 0.7761
loss: 0.1064, acc: 0.9688, test_acc: 0.8290, f1: 0.7679
loss: 0.1130, acc: 0.9700, test_acc: 0.8074, f1: 0.7128
loss: 0.1542, acc: 0.9699, test_acc: 0.8182, f1: 0.7525
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.0534, acc: 1.0000, test_acc: 0.8268, f1: 0.7727
loss: 0.0818, acc: 0.9844, test_acc: 0.8333, f1: 0.7486
loss: 0.0234, acc: 0.9896, test_acc: 0.8377, f1: 0.7713
loss: 0.1897, acc: 0.9805, test_acc: 0.8420, f1: 0.7644
loss: 0.0679, acc: 0.9812, test_acc: 0.8312, f1: 0.7408
loss: 0.0516, acc: 0.9818, test_acc: 0.8398, f1: 0.7753
loss: 0.0313, acc: 0.9844, test_acc: 0.8485, f1: 0.7956
loss: 0.1299, acc: 0.9824, test_acc: 0.8225, f1: 0.7339
loss: 0.0303, acc: 0.9826, test_acc: 0.8290, f1: 0.7493
loss: 0.1171, acc: 0.9797, test_acc: 0.8398, f1: 0.7749
loss: 0.0458, acc: 0.9787, test_acc: 0.8355, f1: 0.7797
loss: 0.1100, acc: 0.9779, test_acc: 0.8377, f1: 0.7757
loss: 0.0310, acc: 0.9796, test_acc: 0.8398, f1: 0.7778
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.0216, acc: 0.9844, test_acc: 0.8377, f1: 0.7786
loss: 0.0431, acc: 0.9844, test_acc: 0.8355, f1: 0.7545
loss: 0.0128, acc: 0.9896, test_acc: 0.8420, f1: 0.7682
loss: 0.0350, acc: 0.9844, test_acc: 0.8377, f1: 0.7632
loss: 0.0085, acc: 0.9875, test_acc: 0.8377, f1: 0.7791
loss: 0.0162, acc: 0.9896, test_acc: 0.8485, f1: 0.7982
loss: 0.0058, acc: 0.9911, test_acc: 0.8442, f1: 0.7797
loss: 0.1156, acc: 0.9883, test_acc: 0.8312, f1: 0.7493
loss: 0.0521, acc: 0.9878, test_acc: 0.8463, f1: 0.7872
loss: 0.0203, acc: 0.9891, test_acc: 0.8506, f1: 0.7984
loss: 0.0094, acc: 0.9901, test_acc: 0.8463, f1: 0.7876
loss: 0.0425, acc: 0.9883, test_acc: 0.8442, f1: 0.7779
loss: 0.0269, acc: 0.9892, test_acc: 0.8442, f1: 0.7796
loss: 0.0050, acc: 0.9897, test_acc: 0.8463, f1: 0.7810
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.0211, acc: 1.0000, test_acc: 0.8485, f1: 0.7793
loss: 0.0308, acc: 0.9922, test_acc: 0.8463, f1: 0.7741
loss: 0.0084, acc: 0.9948, test_acc: 0.8463, f1: 0.7872
loss: 0.1277, acc: 0.9883, test_acc: 0.8420, f1: 0.7861
loss: 0.0157, acc: 0.9906, test_acc: 0.8398, f1: 0.7808
loss: 0.0504, acc: 0.9896, test_acc: 0.8355, f1: 0.7683
loss: 0.0149, acc: 0.9911, test_acc: 0.8355, f1: 0.7802
loss: 0.0493, acc: 0.9902, test_acc: 0.8355, f1: 0.7809
loss: 0.0055, acc: 0.9913, test_acc: 0.8268, f1: 0.7614
loss: 0.0045, acc: 0.9922, test_acc: 0.8160, f1: 0.7445
loss: 0.0072, acc: 0.9929, test_acc: 0.8290, f1: 0.7651
loss: 0.1551, acc: 0.9909, test_acc: 0.8377, f1: 0.7790
loss: 0.0292, acc: 0.9904, test_acc: 0.8355, f1: 0.7690
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.1104, acc: 0.9531, test_acc: 0.8290, f1: 0.7524
loss: 0.0387, acc: 0.9688, test_acc: 0.8268, f1: 0.7550
loss: 0.0634, acc: 0.9740, test_acc: 0.8290, f1: 0.7634
loss: 0.0749, acc: 0.9727, test_acc: 0.8312, f1: 0.7717
loss: 0.0044, acc: 0.9781, test_acc: 0.8355, f1: 0.7706
loss: 0.0257, acc: 0.9792, test_acc: 0.8398, f1: 0.7741
loss: 0.1351, acc: 0.9732, test_acc: 0.8355, f1: 0.7755
loss: 0.0097, acc: 0.9766, test_acc: 0.8312, f1: 0.7755
loss: 0.0343, acc: 0.9774, test_acc: 0.8398, f1: 0.7766
loss: 0.1379, acc: 0.9750, test_acc: 0.8225, f1: 0.7323
loss: 0.0159, acc: 0.9773, test_acc: 0.8398, f1: 0.7614
loss: 0.0124, acc: 0.9792, test_acc: 0.8333, f1: 0.7706
loss: 0.0563, acc: 0.9784, test_acc: 0.8225, f1: 0.7585
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.0267, acc: 0.9844, test_acc: 0.8312, f1: 0.7727
loss: 0.0079, acc: 0.9922, test_acc: 0.8312, f1: 0.7773
loss: 0.0197, acc: 0.9896, test_acc: 0.8506, f1: 0.7916
loss: 0.0713, acc: 0.9844, test_acc: 0.8398, f1: 0.7705
loss: 0.0090, acc: 0.9875, test_acc: 0.8398, f1: 0.7833
loss: 0.0684, acc: 0.9870, test_acc: 0.8442, f1: 0.7905
loss: 0.1196, acc: 0.9866, test_acc: 0.8398, f1: 0.7696
loss: 0.0056, acc: 0.9883, test_acc: 0.8398, f1: 0.7663
loss: 0.0548, acc: 0.9878, test_acc: 0.8377, f1: 0.7748
loss: 0.0442, acc: 0.9875, test_acc: 0.8442, f1: 0.7861
loss: 0.1108, acc: 0.9858, test_acc: 0.8160, f1: 0.7288
loss: 0.0100, acc: 0.9870, test_acc: 0.8355, f1: 0.7596
loss: 0.0705, acc: 0.9868, test_acc: 0.8333, f1: 0.7685
loss: 0.0427, acc: 0.9855, test_acc: 0.8355, f1: 0.7805
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.0048, acc: 1.0000, test_acc: 0.8442, f1: 0.7897
loss: 0.0989, acc: 0.9844, test_acc: 0.8485, f1: 0.7915
loss: 0.0087, acc: 0.9896, test_acc: 0.8442, f1: 0.7703
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8571_f1_0.7993
loss: 0.0081, acc: 0.9922, test_acc: 0.8571, f1: 0.7993
loss: 0.0047, acc: 0.9938, test_acc: 0.8442, f1: 0.7898
loss: 0.0154, acc: 0.9948, test_acc: 0.8463, f1: 0.7890
loss: 0.0418, acc: 0.9911, test_acc: 0.8485, f1: 0.7875
loss: 0.0625, acc: 0.9902, test_acc: 0.8506, f1: 0.7983
loss: 0.0233, acc: 0.9896, test_acc: 0.8442, f1: 0.7835
loss: 0.0529, acc: 0.9891, test_acc: 0.8463, f1: 0.7818
loss: 0.0072, acc: 0.9901, test_acc: 0.8485, f1: 0.7876
loss: 0.0060, acc: 0.9909, test_acc: 0.8528, f1: 0.8013
loss: 0.0138, acc: 0.9916, test_acc: 0.8442, f1: 0.7924
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.0281, acc: 0.9844, test_acc: 0.8333, f1: 0.7677
loss: 0.0066, acc: 0.9922, test_acc: 0.8333, f1: 0.7617
loss: 0.0942, acc: 0.9896, test_acc: 0.8333, f1: 0.7490
loss: 0.0858, acc: 0.9883, test_acc: 0.8463, f1: 0.7823
loss: 0.1792, acc: 0.9781, test_acc: 0.8377, f1: 0.7764
loss: 0.0058, acc: 0.9818, test_acc: 0.8420, f1: 0.7871
loss: 0.0812, acc: 0.9799, test_acc: 0.8420, f1: 0.7876
loss: 0.0477, acc: 0.9785, test_acc: 0.8312, f1: 0.7653
loss: 0.0066, acc: 0.9809, test_acc: 0.8485, f1: 0.7845
loss: 0.0039, acc: 0.9828, test_acc: 0.8463, f1: 0.7738
loss: 0.0595, acc: 0.9830, test_acc: 0.8290, f1: 0.7515
loss: 0.0414, acc: 0.9831, test_acc: 0.8225, f1: 0.7599
loss: 0.0422, acc: 0.9832, test_acc: 0.8225, f1: 0.7575
loss: 0.0174, acc: 0.9840, test_acc: 0.8355, f1: 0.7678
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.0023, acc: 1.0000, test_acc: 0.8398, f1: 0.7692
loss: 0.0074, acc: 1.0000, test_acc: 0.8398, f1: 0.7715
loss: 0.0203, acc: 0.9948, test_acc: 0.8398, f1: 0.7698
loss: 0.0217, acc: 0.9922, test_acc: 0.8463, f1: 0.7703
loss: 0.0714, acc: 0.9906, test_acc: 0.8485, f1: 0.7795
loss: 0.1099, acc: 0.9896, test_acc: 0.8225, f1: 0.7541
loss: 0.0202, acc: 0.9888, test_acc: 0.8247, f1: 0.7634
loss: 0.0753, acc: 0.9863, test_acc: 0.8550, f1: 0.7886
loss: 0.0024, acc: 0.9878, test_acc: 0.8312, f1: 0.7403
loss: 0.0985, acc: 0.9859, test_acc: 0.8420, f1: 0.7675
loss: 0.0375, acc: 0.9858, test_acc: 0.8312, f1: 0.7661
loss: 0.0043, acc: 0.9870, test_acc: 0.8377, f1: 0.7758
loss: 0.0076, acc: 0.9880, test_acc: 0.8463, f1: 0.7850
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.0107, acc: 1.0000, test_acc: 0.8442, f1: 0.7815
loss: 0.0639, acc: 0.9922, test_acc: 0.8463, f1: 0.7786
loss: 0.0669, acc: 0.9896, test_acc: 0.8550, f1: 0.7889
loss: 0.0016, acc: 0.9922, test_acc: 0.8506, f1: 0.7805
loss: 0.0062, acc: 0.9938, test_acc: 0.8463, f1: 0.7764
loss: 0.0226, acc: 0.9922, test_acc: 0.8506, f1: 0.7899
loss: 0.0037, acc: 0.9933, test_acc: 0.8463, f1: 0.7838
loss: 0.0822, acc: 0.9922, test_acc: 0.8333, f1: 0.7719
loss: 0.0197, acc: 0.9913, test_acc: 0.8290, f1: 0.7694
loss: 0.0725, acc: 0.9906, test_acc: 0.8485, f1: 0.7911
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8615_f1_0.7977
loss: 0.0167, acc: 0.9915, test_acc: 0.8615, f1: 0.7977
loss: 0.0365, acc: 0.9909, test_acc: 0.8550, f1: 0.7902
loss: 0.0258, acc: 0.9904, test_acc: 0.8506, f1: 0.7813
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.0027, acc: 1.0000, test_acc: 0.8506, f1: 0.7917
loss: 0.0016, acc: 1.0000, test_acc: 0.8485, f1: 0.7917
loss: 0.0115, acc: 1.0000, test_acc: 0.8398, f1: 0.7779
loss: 0.0057, acc: 1.0000, test_acc: 0.8377, f1: 0.7752
loss: 0.0028, acc: 1.0000, test_acc: 0.8442, f1: 0.7834
loss: 0.0534, acc: 0.9974, test_acc: 0.8420, f1: 0.7792
loss: 0.0057, acc: 0.9978, test_acc: 0.8377, f1: 0.7746
loss: 0.0008, acc: 0.9980, test_acc: 0.8506, f1: 0.7857
loss: 0.0021, acc: 0.9983, test_acc: 0.8571, f1: 0.8042
loss: 0.0017, acc: 0.9984, test_acc: 0.8528, f1: 0.7982
loss: 0.0112, acc: 0.9986, test_acc: 0.8528, f1: 0.8017
loss: 0.0026, acc: 0.9987, test_acc: 0.8485, f1: 0.7910
loss: 0.0150, acc: 0.9976, test_acc: 0.8528, f1: 0.7910
loss: 0.0015, acc: 0.9978, test_acc: 0.8442, f1: 0.7654
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.0045, acc: 1.0000, test_acc: 0.8463, f1: 0.7677
loss: 0.0057, acc: 1.0000, test_acc: 0.8550, f1: 0.8024
loss: 0.0050, acc: 1.0000, test_acc: 0.8506, f1: 0.7986
loss: 0.0380, acc: 0.9961, test_acc: 0.8463, f1: 0.7903
loss: 0.0043, acc: 0.9969, test_acc: 0.8506, f1: 0.7892
loss: 0.0053, acc: 0.9974, test_acc: 0.8485, f1: 0.7853
loss: 0.0019, acc: 0.9978, test_acc: 0.8528, f1: 0.7930
loss: 0.0017, acc: 0.9980, test_acc: 0.8506, f1: 0.7862
loss: 0.0011, acc: 0.9983, test_acc: 0.8506, f1: 0.7818
loss: 0.0041, acc: 0.9984, test_acc: 0.8398, f1: 0.7564
loss: 0.0163, acc: 0.9972, test_acc: 0.8463, f1: 0.7754
loss: 0.0059, acc: 0.9974, test_acc: 0.8312, f1: 0.7682
loss: 0.0323, acc: 0.9964, test_acc: 0.8355, f1: 0.7818
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.0018, acc: 1.0000, test_acc: 0.8528, f1: 0.7994
loss: 0.0322, acc: 0.9922, test_acc: 0.8550, f1: 0.7927
loss: 0.0095, acc: 0.9948, test_acc: 0.8528, f1: 0.7916
loss: 0.0010, acc: 0.9961, test_acc: 0.8593, f1: 0.8012
loss: 0.1024, acc: 0.9906, test_acc: 0.8506, f1: 0.7887
loss: 0.1919, acc: 0.9870, test_acc: 0.8247, f1: 0.7493
loss: 0.0102, acc: 0.9888, test_acc: 0.8463, f1: 0.7761
loss: 0.0170, acc: 0.9902, test_acc: 0.8398, f1: 0.7886
loss: 0.0542, acc: 0.9878, test_acc: 0.8442, f1: 0.7860
loss: 0.0081, acc: 0.9891, test_acc: 0.8333, f1: 0.7634
loss: 0.0019, acc: 0.9901, test_acc: 0.8528, f1: 0.7915
loss: 0.0058, acc: 0.9909, test_acc: 0.8593, f1: 0.7972
loss: 0.0048, acc: 0.9916, test_acc: 0.8571, f1: 0.7990
loss: 0.0037, acc: 0.9920, test_acc: 0.8506, f1: 0.7877
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 20
loss: 0.0037, acc: 1.0000, test_acc: 0.8528, f1: 0.7913
loss: 0.0153, acc: 0.9922, test_acc: 0.8485, f1: 0.7887
loss: 0.0036, acc: 0.9948, test_acc: 0.8463, f1: 0.7839
loss: 0.0023, acc: 0.9961, test_acc: 0.8506, f1: 0.7888
loss: 0.0130, acc: 0.9969, test_acc: 0.8485, f1: 0.7805
loss: 0.0054, acc: 0.9974, test_acc: 0.8420, f1: 0.7770
loss: 0.0021, acc: 0.9978, test_acc: 0.8420, f1: 0.7740
loss: 0.0070, acc: 0.9980, test_acc: 0.8485, f1: 0.7838
loss: 0.0023, acc: 0.9983, test_acc: 0.8571, f1: 0.8001
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8636_f1_0.8103
loss: 0.1314, acc: 0.9969, test_acc: 0.8636, f1: 0.8103
loss: 0.0009, acc: 0.9972, test_acc: 0.8593, f1: 0.8004
loss: 0.0018, acc: 0.9974, test_acc: 0.8571, f1: 0.7935
loss: 0.0012, acc: 0.9976, test_acc: 0.8550, f1: 0.7926
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 21
loss: 0.0132, acc: 0.9844, test_acc: 0.8463, f1: 0.7693
loss: 0.0044, acc: 0.9922, test_acc: 0.8442, f1: 0.7700
loss: 0.0052, acc: 0.9948, test_acc: 0.8463, f1: 0.7800
loss: 0.0111, acc: 0.9961, test_acc: 0.8485, f1: 0.7896
loss: 0.0012, acc: 0.9969, test_acc: 0.8485, f1: 0.7877
loss: 0.0006, acc: 0.9974, test_acc: 0.8485, f1: 0.7876
loss: 0.0004, acc: 0.9978, test_acc: 0.8550, f1: 0.7945
loss: 0.0034, acc: 0.9980, test_acc: 0.8528, f1: 0.7910
loss: 0.0021, acc: 0.9983, test_acc: 0.8615, f1: 0.7982
loss: 0.0026, acc: 0.9984, test_acc: 0.8528, f1: 0.7967
loss: 0.0009, acc: 0.9986, test_acc: 0.8528, f1: 0.7921
loss: 0.0004, acc: 0.9987, test_acc: 0.8571, f1: 0.7869
loss: 0.1007, acc: 0.9976, test_acc: 0.8506, f1: 0.7783
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 22
loss: 0.0054, acc: 1.0000, test_acc: 0.8550, f1: 0.7905
loss: 0.0021, acc: 1.0000, test_acc: 0.8528, f1: 0.7966
loss: 0.0286, acc: 0.9948, test_acc: 0.8506, f1: 0.7937
loss: 0.0028, acc: 0.9961, test_acc: 0.8333, f1: 0.7697
loss: 0.1351, acc: 0.9906, test_acc: 0.8506, f1: 0.7875
loss: 0.0009, acc: 0.9922, test_acc: 0.8420, f1: 0.7663
loss: 0.0422, acc: 0.9911, test_acc: 0.8463, f1: 0.7725
loss: 0.0348, acc: 0.9902, test_acc: 0.8442, f1: 0.7716
loss: 0.0026, acc: 0.9913, test_acc: 0.8420, f1: 0.7727
loss: 0.0045, acc: 0.9922, test_acc: 0.8442, f1: 0.7750
loss: 0.0016, acc: 0.9929, test_acc: 0.8485, f1: 0.7787
loss: 0.0342, acc: 0.9922, test_acc: 0.8312, f1: 0.7727
loss: 0.0479, acc: 0.9904, test_acc: 0.8463, f1: 0.7839
loss: 0.0022, acc: 0.9911, test_acc: 0.8420, f1: 0.7635
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 23
loss: 0.0114, acc: 1.0000, test_acc: 0.8442, f1: 0.7739
loss: 0.0028, acc: 1.0000, test_acc: 0.8463, f1: 0.7901
loss: 0.0610, acc: 0.9948, test_acc: 0.8333, f1: 0.7860
loss: 0.0062, acc: 0.9961, test_acc: 0.8377, f1: 0.7898
loss: 0.0018, acc: 0.9969, test_acc: 0.8463, f1: 0.7906
loss: 0.0024, acc: 0.9974, test_acc: 0.8571, f1: 0.8020
loss: 0.0209, acc: 0.9955, test_acc: 0.8615, f1: 0.8063
loss: 0.0853, acc: 0.9922, test_acc: 0.8528, f1: 0.7921
loss: 0.0991, acc: 0.9913, test_acc: 0.8506, f1: 0.7878
loss: 0.0014, acc: 0.9922, test_acc: 0.8420, f1: 0.7756
loss: 0.0893, acc: 0.9915, test_acc: 0.8463, f1: 0.7815
loss: 0.0025, acc: 0.9922, test_acc: 0.8506, f1: 0.7885
loss: 0.0020, acc: 0.9928, test_acc: 0.8485, f1: 0.7885
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 24
loss: 0.0072, acc: 1.0000, test_acc: 0.8550, f1: 0.7991
loss: 0.0852, acc: 0.9844, test_acc: 0.8312, f1: 0.7675
loss: 0.0054, acc: 0.9896, test_acc: 0.8247, f1: 0.7426
loss: 0.0015, acc: 0.9922, test_acc: 0.8377, f1: 0.7689
loss: 0.0125, acc: 0.9938, test_acc: 0.8442, f1: 0.7770
loss: 0.0093, acc: 0.9948, test_acc: 0.8442, f1: 0.7849
loss: 0.0802, acc: 0.9933, test_acc: 0.8506, f1: 0.7943
loss: 0.0046, acc: 0.9941, test_acc: 0.8485, f1: 0.7714
loss: 0.1356, acc: 0.9931, test_acc: 0.8225, f1: 0.7406
loss: 0.1797, acc: 0.9906, test_acc: 0.8355, f1: 0.7687
loss: 0.1492, acc: 0.9886, test_acc: 0.8225, f1: 0.7518
loss: 0.0675, acc: 0.9896, test_acc: 0.8333, f1: 0.7619
loss: 0.0697, acc: 0.9892, test_acc: 0.8333, f1: 0.7665
loss: 0.0266, acc: 0.9885, test_acc: 0.8290, f1: 0.7666
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 25
loss: 0.0095, acc: 1.0000, test_acc: 0.8420, f1: 0.7753
loss: 0.0183, acc: 1.0000, test_acc: 0.8268, f1: 0.7454
loss: 0.0634, acc: 0.9896, test_acc: 0.8398, f1: 0.7766
loss: 0.0918, acc: 0.9766, test_acc: 0.8312, f1: 0.7684
loss: 0.0472, acc: 0.9781, test_acc: 0.8312, f1: 0.7466
loss: 0.2215, acc: 0.9661, test_acc: 0.8355, f1: 0.7750
loss: 0.0068, acc: 0.9710, test_acc: 0.8290, f1: 0.7612
loss: 0.0484, acc: 0.9727, test_acc: 0.8203, f1: 0.7414
loss: 0.1102, acc: 0.9740, test_acc: 0.8268, f1: 0.7634
loss: 0.0674, acc: 0.9734, test_acc: 0.8268, f1: 0.7627
loss: 0.1127, acc: 0.9744, test_acc: 0.8203, f1: 0.7415
loss: 0.0817, acc: 0.9753, test_acc: 0.8312, f1: 0.7627
loss: 0.0746, acc: 0.9748, test_acc: 0.8355, f1: 0.7763
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 26
loss: 0.0100, acc: 1.0000, test_acc: 0.8377, f1: 0.7762
loss: 0.0080, acc: 1.0000, test_acc: 0.8290, f1: 0.7601
loss: 0.0468, acc: 0.9948, test_acc: 0.8377, f1: 0.7805
loss: 0.0516, acc: 0.9961, test_acc: 0.8225, f1: 0.7458
loss: 0.0811, acc: 0.9906, test_acc: 0.8117, f1: 0.7184
loss: 0.1914, acc: 0.9844, test_acc: 0.8333, f1: 0.7632
loss: 0.0248, acc: 0.9866, test_acc: 0.8398, f1: 0.7771
loss: 0.0863, acc: 0.9863, test_acc: 0.8333, f1: 0.7660
loss: 0.1759, acc: 0.9844, test_acc: 0.8247, f1: 0.7556
loss: 0.1718, acc: 0.9828, test_acc: 0.8290, f1: 0.7635
loss: 0.1509, acc: 0.9787, test_acc: 0.8182, f1: 0.7480
loss: 0.2827, acc: 0.9714, test_acc: 0.7468, f1: 0.6880
loss: 0.2281, acc: 0.9663, test_acc: 0.7619, f1: 0.6093
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 27
loss: 0.2524, acc: 0.8906, test_acc: 0.7814, f1: 0.6692
loss: 0.3355, acc: 0.8984, test_acc: 0.7944, f1: 0.7115
loss: 0.1496, acc: 0.9167, test_acc: 0.8182, f1: 0.7460
loss: 0.2363, acc: 0.9219, test_acc: 0.8095, f1: 0.7252
loss: 0.2299, acc: 0.9250, test_acc: 0.8139, f1: 0.7251
loss: 0.2602, acc: 0.9245, test_acc: 0.7511, f1: 0.6207
loss: 0.5891, acc: 0.8996, test_acc: 0.7446, f1: 0.6278
loss: 0.5344, acc: 0.8906, test_acc: 0.7229, f1: 0.5860
loss: 0.5921, acc: 0.8854, test_acc: 0.7554, f1: 0.6570
loss: 0.3010, acc: 0.8859, test_acc: 0.7879, f1: 0.7164
loss: 0.1567, acc: 0.8920, test_acc: 0.8030, f1: 0.7149
loss: 0.2029, acc: 0.8958, test_acc: 0.8052, f1: 0.7216
loss: 0.2846, acc: 0.8966, test_acc: 0.8074, f1: 0.7308
loss: 0.3210, acc: 0.8984, test_acc: 0.8160, f1: 0.7443
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 28
loss: 0.1765, acc: 0.9531, test_acc: 0.8117, f1: 0.7493
loss: 0.1351, acc: 0.9531, test_acc: 0.8117, f1: 0.7374
loss: 0.2526, acc: 0.9531, test_acc: 0.8139, f1: 0.7104
loss: 0.2554, acc: 0.9492, test_acc: 0.8160, f1: 0.7108
loss: 0.0870, acc: 0.9563, test_acc: 0.8139, f1: 0.7332
loss: 0.1968, acc: 0.9557, test_acc: 0.8009, f1: 0.7399
loss: 0.4184, acc: 0.9464, test_acc: 0.7900, f1: 0.7152
loss: 0.1638, acc: 0.9492, test_acc: 0.7706, f1: 0.6740
loss: 0.1744, acc: 0.9497, test_acc: 0.7684, f1: 0.6637
loss: 0.1718, acc: 0.9516, test_acc: 0.8052, f1: 0.7231
loss: 0.1321, acc: 0.9517, test_acc: 0.8117, f1: 0.7442
loss: 0.0615, acc: 0.9544, test_acc: 0.8117, f1: 0.7481
loss: 0.1035, acc: 0.9555, test_acc: 0.8139, f1: 0.7569
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 29
loss: 0.0674, acc: 0.9688, test_acc: 0.8117, f1: 0.7540
loss: 0.1416, acc: 0.9688, test_acc: 0.8117, f1: 0.7498
loss: 0.2221, acc: 0.9688, test_acc: 0.8182, f1: 0.7494
loss: 0.0404, acc: 0.9766, test_acc: 0.8203, f1: 0.7467
loss: 0.1039, acc: 0.9781, test_acc: 0.8203, f1: 0.7510
loss: 0.0161, acc: 0.9818, test_acc: 0.8203, f1: 0.7486
loss: 0.0477, acc: 0.9821, test_acc: 0.8225, f1: 0.7589
loss: 0.0913, acc: 0.9805, test_acc: 0.8139, f1: 0.7511
loss: 0.2185, acc: 0.9757, test_acc: 0.8160, f1: 0.7490
loss: 0.0444, acc: 0.9766, test_acc: 0.8182, f1: 0.7503
loss: 0.1020, acc: 0.9773, test_acc: 0.8117, f1: 0.7394
loss: 0.0173, acc: 0.9792, test_acc: 0.8139, f1: 0.7395
loss: 0.0386, acc: 0.9796, test_acc: 0.8117, f1: 0.7386
loss: 0.2951, acc: 0.9782, test_acc: 0.8203, f1: 0.7476
max_test_acc: 0.8636363636363636, max_f1: 0.8103346826676412
>> saved: ./state_dict/ssegcnbert_ot_2_restaurant_acc_0.8636_f1_0.8103
############################################################
max_test_acc_overall:0.8636363636363636
max_f1_overall:0.8103346826676412
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           0     0.9204    0.9333    0.9268       285
           1     0.8333    0.8247    0.8290        97
           2     0.6883    0.6625    0.6752        80

    accuracy                         0.8636       462
   macro avg     0.8140    0.8069    0.8103       462
weighted avg     0.8619    0.8636    0.8627       462

Confusion Matrix...
[[266   7  12]
 [  5  80  12]
 [ 18   9  53]]
